<!doctype html>
<html class="docs-html">

<head>
  <meta charset="utf-8">
  <title>Conserving battery power - Telenor NB-IoT Docs and Tutorials</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Twitter Card data -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Conserving battery power - Telenor NB-IoT Docs and Tutorials">
  <meta name="twitter:description" content="">
  <meta name="twitter:image" content="https://docs.nbiot.engineering/img/og_image.jpg">

  <!-- Open Graph data -->
  <meta property="og:title" content="Conserving battery power - Telenor NB-IoT Docs and Tutorials" />
  <meta property="og:type" content="article" />
  <meta property="og:url" content="https://docs.nbiot.engineering/tutorials/low-power.html" />
  <meta property="og:image" content="https://docs.nbiot.engineering/img/og_image.jpg" />
  <meta property="og:description" content="" />
  <meta property="og:site_name" content="Telenor NB-IoT Docs and Tutorials" />

  <link rel="stylesheet" type="text/css" href="/style/style.css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link id="searchIndex" href="/index.json" rel="preload" as="fetch">
</head>

<body class="docs-body">
  <div class="docs-brand-border"></div>
  <div id="docs-topbar" class="docs-topbar no-print">
    <div id="docs-topbar__inner" class="docs-topbar__inner">
      <a href="#" id="docs-menu-toggle" class="docs-topbar__icon docs-topbar__icon--menu-toggle hidden-desktop"><i
          class="material-icons md-24">menu</i></a>
      <a href="#" id="docs-search-hide" class="docs-topbar__icon docs-topbar__icon--search-hide hidden-desktop"><i
          class="material-icons md-24">arrow_back</i></a>
      <div class="docs-topbar__icon docs-topbar__icon--search visible-desktop"><i class="material-icons md-24">search</i></div>
      <input id="docs-search-box" type="text" class="docs-topbar__search-box" placeholder="Search" tabindex="1"
        autocapitalize="none" autocomplete="off" autocorrect="off" autofocus />
      <a href="#" id="docs-search-close" class="docs-topbar__icon docs-topbar__icon--search-close"><i class="material-icons md-24">close</i></a>
      <a href="#" id="docs-search-show" class="docs-topbar__icon docs-topbar__icon-search-show hidden-desktop"><i class="material-icons md-24">search</i></a>

      <a class="docs-topbar__link visible-desktop" href="https://github.com/ExploratoryEngineering/docs.nbiot.engineering">On Github</a>
    </div>
    <div id="docs-search" class="docs-search">
      <ul id="docs-search-results" class="docs-search-results"></ul>
    </div>
  </div>
  <div id="docs-sidebar" class="docs-sidebar visible-desktop no-print">
    <nav class="docs-nav">
      <a class="docs-nav__logo" href="/">NB-IoT Docs</a>
      <ul class="docs-nav__ul">
              <li class="docs-nav__li docs-nav__li--subgroup">
                        <a href="/tutorials.html" class="docs-nav__item">Tutorials</a>
                  <ul class="docs-nav__ul">
                          <li class="docs-nav__li">
                                    <a href="/tutorials/getting-started.html" class="docs-nav__item">Getting started with Telenor NB-IoT Developer Platform</a>
                          </li>
                          <li class="docs-nav__li">
                                    <a href="/tutorials/interactive-terminal.html" class="docs-nav__item">Interactive terminal</a>
                          </li>
                          <li class="docs-nav__li">
                                    <a href="/tutorials/arduino-basic.html" class="docs-nav__item">Arduino getting started</a>
                          </li>
                          <li class="docs-nav__li">
                                    <a href="/tutorials/microbit-basic.html" class="docs-nav__item">NB-IoT on micro:bit</a>
                          </li>
                          <li class="docs-nav__li">
                                    <a href="/tutorials/nrf9160-basic.html" class="docs-nav__item">nRF9160 DK getting started</a>
                              <ul class="docs-nav__ul">
                                      <li class="docs-nav__li">
                                                <a href="/tutorials/nrf9160-basic/virtualbox.html" class="docs-nav__item">VirtualBox</a>
                                      </li>
                              </ul>
                          </li>
                          <li class="docs-nav__li">
                                    <a href="/tutorials/raspi-serial.html" class="docs-nav__item">Raspberry Pi getting started</a>
                          </li>
                          <li class="docs-nav__li">
                                    <a href="/tutorials/arduino-serial-forwarder.html" class="docs-nav__item">Arduino as serial adapter</a>
                          </li>
                          <li class="docs-nav__li">
                                    <a href="/tutorials/low-power.html" class="docs-nav__item">Conserving battery power</a>
                          </li>
                  </ul>
              </li>
              <li class="docs-nav__li docs-nav__li--subgroup">
                        <a href="/libs.html" class="docs-nav__item">Client libraries</a>
                  <ul class="docs-nav__ul">
                          <li class="docs-nav__li">
                                    <a href="/libs/csharp.html" class="docs-nav__item">C#</a>
                          </li>
                          <li class="docs-nav__li">
                                    <a href="/libs/go.html" class="docs-nav__item">Go</a>
                          </li>
                          <li class="docs-nav__li">
                                    <a href="/libs/java.html" class="docs-nav__item">Java</a>
                          </li>
                          <li class="docs-nav__li">
                                    <a href="/libs/python.html" class="docs-nav__item">Python</a>
                          </li>
                  </ul>
              </li>
              <li class="docs-nav__li docs-nav__li--subgroup">
                        <a href="/api.html" class="docs-nav__item">REST API</a>
                  <ul class="docs-nav__ul">
                          <li class="docs-nav__li">
                                    <a href="/api/collections.html" class="docs-nav__item">Collections</a>
                          </li>
                          <li class="docs-nav__li">
                                    <a href="/api/devices.html" class="docs-nav__item">Devices</a>
                          </li>
                          <li class="docs-nav__li">
                                    <a href="/api/outputs.html" class="docs-nav__item">Outputs</a>
                          </li>
                          <li class="docs-nav__li">
                                    <a href="/api/teams.html" class="docs-nav__item">Teams</a>
                          </li>
                          <li class="docs-nav__li">
                                    <a href="/api/invites.html" class="docs-nav__item">Team invites</a>
                          </li>
                          <li class="docs-nav__li">
                                    <a href="/api/tags.html" class="docs-nav__item">Tags on resources</a>
                          </li>
                          <li class="docs-nav__li">
                                    <a href="/api/tokens.html" class="docs-nav__item">Tokens</a>
                          </li>
                          <li class="docs-nav__li">
                                    <a href="/api/firmware.html" class="docs-nav__item">Firmware Over the Air (FOTA)</a>
                          </li>
                          <li class="docs-nav__li">
                                    <a href="/api/methods.html" class="docs-nav__item">HTTP Methods</a>
                          </li>
                          <li class="docs-nav__li">
                                    <a href="/api/status_codes.html" class="docs-nav__item">Status codes</a>
                          </li>
                          <li class="docs-nav__li">
                                    <a href="/api/errors.html" class="docs-nav__item">Errors</a>
                          </li>
                  </ul>
              </li>
      </ul>
      <hr class="docs-nav__hr" />
      <ul class="docs-nav__ul">
              <li class="docs-nav__li">
                        <a href="/about.html" class="docs-nav__item">About</a>
              </li>
              <li class="docs-nav__li">
                        <a href="/faq.html" class="docs-nav__item">FAQ</a>
              </li>
      </ul>
      <div class="docs-sidebar__menuLinks hidden-desktop">
        <hr class="docs-nav__hr" />
        <ul class="docs-nav__ul">
          <li class="docs-nav__li">
            <a href="https://github.com/ExploratoryEngineering/docs.nbiot.engineering" class="docs-nav__item">On Github</a>
          </li>
        </ul>
      </div>
    </nav>
  </div>
  <div id="barba-wrapper" class="docs-wrapper">
    <div class="docs-content barba-container">
      <h1>Conserving battery power</h1>
      <ol class="docs-breadcrumbs tn-breadcrumbs visible-desktop">
              <li class="tn-breadcrumb">
                  <a href="/">Home</a>
              </li>
            <li class="tn-breadcrumb">
                    <a href="/tutorials.html">Tutorials</a>
            </li>
          <li class="tn-breadcrumb tn-breadcrumb--active">Conserving battery power</li>
      </ol>
      <p>This is an advanced topic! To be able to run a device on batteries for several years, everything on the device needs to use as little power as possible. The <a href="https://shop.exploratory.engineering/collections/frontpage/products/ee-nbiot-01-v1-1-breakout-module">EE-NBIOT-01</a> is only for prototyping, so this guide will only focus on reducing power consumption on the u-blox SARA-N210 to make it run on batteries for a few weeks and maybe a couple of months.</p>
<h2 id="skip-the-voltage-regulator">Skip the voltage regulator</h2>
<p>First thing you want to do is to bypass the voltage regulator on the <a href="https://shop.exploratory.engineering/collections/frontpage/products/ee-nbiot-01-v1-1-breakout-module">EE-NBIOT-01</a>. The regulator will always draw ~5 mA - even when the SARA-N210 is in power saving mode. The output from the voltage regulator is 3.3V, which is connected to the 3v3-pin. SARA-N210 is specified to work in the range 3.1V-4.0V. Which means you can connect a battery to the 3v3-pin as long as it’s in the right voltage range. A 3.7V lithium-ion battery is at 4.2V when fully charged, but if you make sure it’s no higher than 4.0V it should work fine - for prototyping.</p>
<h2 id="psm-power-saving-mode">PSM - Power Saving Mode</h2>
<p>To save power, you should keep the SARA-N210 always powered. Maybe a surprise to many, but every time you power on the module it has to do a registration process to the network - which draws a lot of power. By using the power saving mode on the SARA-N210 it will only draw a few µA in between transmissions.</p>
<p>Power saving mode is disabled by default on the SARA-N210. With PSM disabled it will consumes a few milliamps even in idle mode. This might not sound like much power consumption, but it’s around 1000 times more power than in deep sleep, and will drastically reduce battery life. If you enable PSM, everything on the SARA-N210 except the real time clock will power down between sending data. You can still communicate with it over the serial connection, since it will wake up when receiving serial data.</p>
<p>Power consumption in power saving mode is specified as ~4 µA. Lower than the Fluke 175 is able to measure. Below you can see the current consumption during send, and that it uses very little power before and after (when in PSM).
<img src="img/psm.gif" alt="Power save mode demo"></p>
<p>When enabling PSM you can also set two timer values, which each have their special 3GPP encoding:</p>
<ul>
<li>Requested Periodic TAU (Tracking Area Update) T3412 - How often the device will wake up from PSM and listen for updates from the network. If new downstream data is available, you’ll get a <code>+NSONMI:</code> message indicating what socket and how many bytes are available. To conserve battery set this to a high value - hours/days between each TAU. 70 hours is encoded as <code>01000111</code>. See table T3412 below for encoding information.</li>
<li>Requested Active Time T3324 - How long to stay in active mode after sending before going into PSM. Set to as low as possible to conserve battery - <code>00000000</code> means as soon as possible. See table T3324 below for coding information.</li>
</ul>
<p>To enable PSM with most conservative power settings:</p>
<pre><code>AT+CPSMS=1,,,&quot;11111111&quot;,&quot;00000000&quot;
&gt; OK</code></pre><h3 id="t3412-encoding">T3412 encoding</h3>
<p>The 3 most significant bits define the timer unit, while the 5 least significant bits define the timer value.</p>
<table>
<thead>
<tr>
<th align="right">Bits 6-8</th>
<th>Timer value unit</th>
</tr>
</thead>
<tbody><tr>
<td align="right">000</td>
<td>10 minutes</td>
</tr>
<tr>
<td align="right">001</td>
<td>1 hour</td>
</tr>
<tr>
<td align="right">010</td>
<td>10 hours</td>
</tr>
<tr>
<td align="right">011</td>
<td>2 seconds</td>
</tr>
<tr>
<td align="right">100</td>
<td>30 seconds</td>
</tr>
<tr>
<td align="right">101</td>
<td>1 minute</td>
</tr>
<tr>
<td align="right">110</td>
<td>320 hours</td>
</tr>
<tr>
<td align="right">111</td>
<td>timer deactivated</td>
</tr>
</tbody></table>
<p>Example: <code>00100110</code>. Unit: 1 hour. Value: <code>00110</code> = 6. Result: 1 hour * 6 = 6 hours.</p>
<h3 id="t3324-encoding">T3324 encoding</h3>
<p>The 3 most significant bits define the timer unit, while the 5 least significant bits define the timer value.</p>
<table>
<thead>
<tr>
<th align="right">Bits 6-8</th>
<th>Timer value unit</th>
</tr>
</thead>
<tbody><tr>
<td align="right">000</td>
<td>2 seconds</td>
</tr>
<tr>
<td align="right">001</td>
<td>1 minute</td>
</tr>
<tr>
<td align="right">010</td>
<td>6 minutes</td>
</tr>
<tr>
<td align="right">111</td>
<td>timer deactivated</td>
</tr>
</tbody></table>
<p>Example: <code>00000010</code>. Unit: 2 seconds. Value <code>00010</code> = 2. Result: 2 seconds * 2 = 4 seconds.</p>
<h2 id="sendto-command-with-flags">sendTo command with flags</h2>
<p>When using PSM, it’s important to use a release indicator when sending data to let the SARA-N210 know when it can go into deep sleep. <code>AT+NSOSTF</code> is almost the same as <code>AT+NSOST</code> that we showed above, except that we can provide a flag.</p>
<p>The syntax is: <code>AT+NSOSTF=&lt;socket&gt;,&lt;remote_ip_address&gt;,&lt;remote_port&gt;,&lt;flag&gt;,&lt;length&gt;,&lt;data&gt;</code> (see <code>AT+NSOST</code> parameters table under “Hello world!”).</p>
<p>Valid <code>&lt;flag&gt;</code> values (<code>Number</code> type)</p>
<table>
<thead>
<tr>
<th align="right">Flag</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td align="right">0x000</td>
<td>No flags</td>
</tr>
<tr>
<td align="right">0x200</td>
<td>Indicate release after next message (enter PSM after send)</td>
</tr>
<tr>
<td align="right">0x400</td>
<td>Indicate release after next message has been replied to (enter PSM after response)</td>
</tr>
</tbody></table>
<p>Example:</p>
<pre><code>AT+NSOSTF=0,&quot;172.16.7.197&quot;,31415,0x200,1,&quot;77&quot;
&gt; OK</code></pre><h2 id="edrx">eDRX</h2>
<p>Extended discontinuous reception (eDRX) is a feature to save power when you expect downstream messages (to the device from the network). Instead of listening all the time, the device can tell the network when it’s sleeping and when it’s listening (receive windows).</p>
<p>If you’re only sending data upstream (from the device), you should disable eDRX to increase battery life:</p>
<pre><code>AT+CEDRXS=3,5</code></pre>
      <div class="lesson-nav">
      </div>
      <a class="docs-edit-btn no-print" href="https://github.com/ExploratoryEngineering/docs.nbiot.engineering/edit/master/docs/tutorials/low-power.md" target="_blank">Edit this page</a>
    </div>
  </div>
  <script src="/script/vendor.js"></script>
  <script src="/script/script.js"></script>
</body>

</html>
